---
layout: single
title:  "Adding Google Analytics to a Jekyll Site"
date:   2018-05-28 17:44:44 -0400
excerpt: "A quick tutorial on how to enable Google Analytics for sites generated by Jekyll."
---
Like many webmasters, I found myself wishing for more information about my web traffic to learn about the users visiting my website. Google offers a free analytics tracking service, [_Google Analytics_][google], that is very popular amongst website administrators.

## Getting Started ##
To get started with the installation process, you must first acquire a Google Analytics tracking ID for your website. After you login to Google Analytics, you will need to create a new property for your website.
<figure>
<a href="/assets/images/analytics/property.png"><img src="/assets/images/analytics/property.png"></a>
</figure>
If you can't find your tracking ID after creating your property, it is located at `Admin > Property > Tracking Info > Tracking Code`.

## Embedding the Tracking Code ##
To configure Google Analytics with your Jekyll site, you must embed the tracking code on every page. Since we are using Jekyll, we can set up our basic layout to include the tracking code in the `<head>` tag of every webpage.

### Include Analytics.js ###
First, create a new file `analytics.html` in your `_includes` directory. Include Google's `analytics.js` script in this file, replacing `UA-XXXXX-Y` with your site's tracking ID.

```js
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-XXXXX-Y', 'auto');
ga('send', 'pageview');
</script>
```

To include this script on every page, you must insert the following code in the `<head>` tag of your default page layout. Typically, this file is called `head.html` in your `_layouts` directory. If you are using a theme, your default layout may be different. In my case, I included the following code in my `default.html` file.
{% raw %}
```django
{% if site.google_analytics and jekyll.environment == 'production' %}
{% include analytics.html %}
{% endif %}
```
{% endraw %}
Note that we include `jekyll.environment == 'production'` in the if statement; this is to ensure Google does not track my webpages while I'm testing the site locally. Github automatically sets the environment to production when it builds the site. If you wanted to build a site locally, and set the environment to production, you would run `JEKYLL_ENV=production bundle exec jekyll build`.
### Add Tracking ID to \_config.yml ###
In your sites `_config.yml` file, add the following lines indicating your Google Analytics tracking ID. Once again, replace `UA-XXXXX-Y` with your personal tracking ID.

```yaml
#Google Analytics
google_analytics: UA-XXXXX-Y
```

[google]: https://www.google.com/analytics/
